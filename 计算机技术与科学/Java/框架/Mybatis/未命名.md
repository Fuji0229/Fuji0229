## 动态sql
```xml
<select id="findActiveBlogWithTitleLike"
     resultType="Blog">
  SELECT * FROM BLOG
  WHERE state = ‘ACTIVE’
  
  <if test="title != null">
    AND title like #{title}
  </if>
  
</select>
```

添加title和author两个参数进行筛选
```xml
<select id="findActiveBlogLike"
     resultType="Blog">
  SELECT * 
  FROM BLOG 
  WHERE state = ‘ACTIVE’
  
  <if test="title != null">
    AND title like #{title}
  </if>
  
  <if test="author != null and author.name != null">
    AND author_name like #{author.name}
  </if>
  
</select>
```

### choose、when、otherwise
choose不想使用所有的条件，而是从多个条件中选取一个。
```xml
<select id="findActiveBlogLike"
     resultType="Blog">
     
  SELECT * FROM BLOG WHERE state = ‘ACTIVE’
  
  <choose>
  
    <when test="title != null">
      AND title like #{title}
    </when>
    
    <when test="author != null and author.name != null">
      AND author_name like #{author.name}
    </when>
    
    <otherwise>
      AND featured = 1
    </otherwise>
    
  </choose>
  
</select>
```

### trim、where、set
会导致没有条件匹配的时候还会有where关键字存在
```xml
<select id="findActiveBlogLike"
     resultType="Blog">
     
  SELECT * 
  FROM BLOG
  WHERE
  
  <if test="state != null">
    state = #{state}
  </if>
  
  <if test="title != null">
    AND title like #{title}
  </if>
  
  <if test="author != null and author.name != null">
    AND author_name like #{author.name}
  </if>
  
</select>
```


此时引入< where > < /where >标签即可解决该问题
改标签只会在子元素返回任何内容时才插入where and，首个条件的and或者or会被省略
``` xml
<select id="findActiveBlogLike"
     resultType="Blog">
  SELECT * FROM BLOG
  
  <where>
    <if test="state != null">
         state = #{state}
    </if>
    
    <if test="title != null">
        AND title like #{title}
    </if>
    
    <if test="author != null and author.name != null">
        AND author_name like #{author.name}
    </if>
    
  </where>
</select>
```

如果where元素与期待的不太一样，可以通过自定义trim元素定制where元素的功能，比如，与where等价的trim元素：
```xml
<trim prefix="WHERE" prefixOverrides="AND |OR ">
  ...
</trim>
```
_prefixOverrides_ 属性会忽略通过管道符分隔的文本序列（注意此例中的空格是必要的）。上述例子会移除所有 _prefixOverrides_ 属性中指定的内容，并且插入 _prefix_ 属性中指定的内容。

用于动态更新语句的类似解决方案叫做 _set_。_set_ 元素可以用于动态包含需要更新的列，忽略其它不更新的列。比如：
```xml
<update id="updateAuthorIfNecessary">
  update Author
    <set>    
      <if test="username != null">username=#{username},</if>
      <if test="password != null">password=#{password},</if>
      <if test="email != null">email=#{email},</if>
      <if test="bio != null">bio=#{bio}</if>      
    </set>    
  where id=#{id}
</update>
```
这个例子中，_set_ 元素会动态地在行首插入 SET 关键字，并会删掉额外的逗号（这些逗号是在使用条件语句给列赋值时引入的）。

与 _set_ 元素等价的自定义 _trim_ 元素：
```xml
<trim prefix="SET" suffixOverrides=",">
  ...
</trim>
```
注意，我们覆盖了后缀值设置，并且自定义了前缀值。

### foreach
动态 SQL 的另一个常见使用场景是对集合进行遍历（尤其是在构建 IN 条件语句的时候）。比如：
<select id="selectPostIn" resultType="domain.blog.Post">
  SELECT *
  FROM POST P
  WHERE ID in
  <foreach item="item" index="index" collection="list"
      open="(" separator="," close=")">
        #{item}
  </foreach>
</select>