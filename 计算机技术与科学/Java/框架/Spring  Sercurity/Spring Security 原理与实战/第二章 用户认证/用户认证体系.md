webSecurityConfigurerAdapter的configure(HttpSecurity http)方法进行配置

## 1.HTTP基础认证和表单登录认证

HTTP基础认证：
	开启方式：http.httpBasic();
	认证方式：通过HTTP的消息头携带用户名和密码进行登录。
HTTP基础认证比较简单，没有定制的页面，一般与表单登录认证结合使用。

表单登录认证：
	开启方式：http.forFormLogin();
	开启后默认会提供一个默认的登录界面
	![[附件/Pasted image 20220916110420.png]]
	可以根据业务场景进行定制化
	![[附件/Pasted image 20220916110508.png]]
	如何改变Spring Security默认的登录用户和密码
	![[附件/Pasted image 20220916110653.png]]
	实际开发中还是以重写webSecurityConfigurerAdapter的configure设置用户的登录账号和密码、角色信息。
## 2.用户信息存储
## 1.基于内存的存储方案
AuthenticationManagerBuilder 的 inMemoryAuthentication()方法
```java
@Override
protected void configure(AuthenticationManagerBuilder builder) throws Exception {

        builder.inMemoryAuthentication()
           .withUser("spring_user")
           .password("password1")
           .roles("USER")
           .and()
           .withUser("spring_admin")
           .password("password2")
           .roles("USER", "ADMIN");
 }
```
注意，这里的 roles()方法背后使用的实际上是 authorities()方法。通过 roles()方法，Spring Security 会为每个角色名称自动添加「ROLE_」前缀。使用authorities方法需要添加前缀「ROLE_」
**缺点**：缺乏灵活性，用户信息固定在代码中。
## 2.基于数据库的存储方案
```java
@Autowired
DataSource dataSource;

@Override
protected void configure(AuthenticationManagerBuilder auth) throws Exception {

    auth.jdbcAuthentication().dataSource(dataSource)
        .usersByUsernameQuery("select username, password, enabled from Users " + "where  
username=?")
        .authoritiesByUsernameQuery("select username, authority from UserAuthorities " + "where username=?")
        .passwordEncoder(new BCryptPasswordEncoder());
}
```

## 用户对象和认证对象
用户对象：描述对象，管理用户信息
四个核心对象：
- UserDetails：描述 Spring Security 中的用户
- GrantedAuthority：定义用户所能执行的操作权限
- UserDetailsService：定义对 UserDetails 的查询操作。
- UserDetailsManager：扩展 UserDetailsService，添加创建用户、修改用户密码等功能。
  ![[附件/Pasted image 20220916112452.png]]
在引出 UserDetailsManager 之后，我们首先了解一下它的两个实现类——基于内存存储的 InMemoryUserDetailsManager 和基于关系型数据库存储的 JdbcUserDetailsManager

认证对象 